#!/bin/bash

launch_micrortps_client () { px4-micrortps_client --instance %(vehicle_id)s start -t UDP -r %(udp_send_port)s  -s %(udp_recv_port)s ; }

sleep 5

while launch_micrortps_client ; ret=$? ; [ $ret -ne 0 ];do
  echo "Trying again"
  sleep 1
done

ros2 run ros2_serial_example ros2_to_serial_bridge  __params:=%(px4_params)s __ns:=/%(vehicle_name)s __node:=%(vehicle_name)s/ros2_to_serial_bridge >> /dev/null
